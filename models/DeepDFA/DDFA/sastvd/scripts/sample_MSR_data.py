import pandas as pd
import os, sys
current_dir = os.getcwd()
parent_dir = os.path.dirname(current_dir)
parent_parent_dir = os.path.dirname(parent_dir)
sys.path.append(current_dir)
sys.path.append(parent_dir)
sys.path.append(parent_parent_dir)
import torch
torch.set_printoptions(threshold=float('inf'))
# 设置显示选项
pd.set_option('display.max_rows', None)
#
import DDFA.sastvd as svd

df = pd.read_csv(svd.external_dir() / "MSR_data_cleaned.csv")
seed = 0
sample_n_from_each_class = 100
cut_df = pd.concat(
    (
        df[df.vul == 0].sample(sample_n_from_each_class, random_state=seed),
        df[df.vul == 1].sample(sample_n_from_each_class, random_state=seed),
    )
)
print(cut_df.columns)
print(cut_df)
cut_df.to_csv(svd.external_dir() / "MSR_data_cleaned_SAMPLE.csv")

df = pd.read_csv(svd.external_dir() / "MSR_data_cleaned_SAMPLE.csv")

# df_new =df[['Unnamed: 0', 'vul']]
#
#
# print(df_new)




"""
     Unnamed: 0  vul
0         31280    0
1         17394    0
2        103064    0
3         71451    0
4         24946    0
5         27155    0
6        176464    0
7         68050    0
8        106220    0
9        105117    0
10        59893    0
11       139236    0
12       149469    0
13       151899    0
14       103605    0
15       159014    0
16        99332    0
17        69628    0
18       159032    0
19       129022    0
20        26811    0
21        85303    0
22       125424    0
23       129238    0
24       136054    0
25       161809    0
26       124733    0
27       177406    0
28       167676    0
29         6626    0
30        41546    0
31       117210    0
32       129217    0
33        44128    0
34        86733    0
35       118546    0
36        60117    0
37         3858    0
38        64537    0
39        82325    0
40       106015    0
41        82403    0
42       156253    0
43        12727    0
44        56162    0
45       108811    0
46        59502    0
47       162954    0
48       115634    0
49       122825    0
50       111763    0
51        81940    0
52       133083    0
53       104553    0
54        32411    0
55         2567    0
56        63209    0
57        77041    0
58         8153    0
59        59309    0
60        81729    0
61        89469    0
62        43384    0
63       105952    0
64       143345    0
65        15652    0
66        88895    0
67        12981    0
68       141380    0
69        69681    0
70       130396    0
71       145516    0
72       122771    0
73       161055    0
74        12221    0
75        58006    0
76        54115    0
77       103612    0
78        10354    0
79        32126    0
80        87555    0
81        63128    0
82       154152    0
83        74142    0
84        98729    0
85        40573    0
86       164515    0
87        44470    0
88        43356    0
89       167243    0
90       112518    0
91        49408    0
92        34238    0
93        81976    0
94         3793    0
95        15551    0
96       105351    0
97        43324    0
98        26090    0
99        87015    0
100      181539    1
101      187368    1
102      178730    1
103      186820    1
104      182162    1
105      184093    1
106      186644    1
107      180626    1
108      184737    1
109      187513    1
110      178223    1
111      183732    1
112      187908    1
113      181289    1
114      185358    1
115      183868    1
116      178906    1
117      184074    1
118      183988    1
119      181550    1
120      183872    1
121      181464    1
122      178685    1
123      186486    1
124      188409    1
125      185680    1
126      181054    1
127      181525    1
128      181485    1
129      183429    1
130      181400    1
131      179028    1
132      181179    1
133      177912    1
134      179720    1
135      184262    1
136      179035    1
137      187585    1
138      184071    1
139      177778    1
140      186120    1
141      180051    1
142      184719    1
143      182147    1
144      180817    1
145      185276    1
146      180755    1
147      178314    1
148      179479    1
149      186945    1
150      178872    1
151      178674    1
152      183412    1
153      185802    1
154      185626    1
155      179095    1
156      186399    1
157      185929    1
158      182179    1
159      186581    1
160      186537    1
161      183900    1
162      183693    1
163      181183    1
164      180366    1
165      184671    1
166      187047    1
167      180948    1
168      182771    1
169      187400    1
170      185271    1
171      182351    1
172      188627    1
173      182826    1
174      180264    1
175      182714    1
176      186370    1
177      188603    1
178      185684    1
179      188573    1
180      187227    1
181      184443    1
182      183074    1
183      185088    1
184      184583    1
185      188541    1
186      187464    1
187      179839    1
188      185916    1
189      188553    1
190      185673    1
191      182159    1
192      186914    1
193      182934    1
194      178997    1
195      188006    1
196      180476    1
197      180190    1
198      181080    1
199      186313    1

"""
