08/19/2022 09:46:29 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of the model checkpoint at microsoft/codebert-base were not used when initializing RobertaForSequenceClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.out_proj.bias', 'classifier.dense.weight', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/19/2022 09:46:35 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file=None, output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file=None, test_data_file='../data/subsets/bug_type/bugtype_value_propagation_errors/test.csv', model_name='bug_type/bugtype_input_validation', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=4, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
load dataset:   0%|          | 0/1512 [00:00<?, ?it/s]load dataset:   1%|▏         | 19/1512 [00:00<00:08, 183.22it/s]load dataset:   4%|▍         | 60/1512 [00:00<00:04, 308.52it/s]load dataset:   6%|▌         | 91/1512 [00:00<00:04, 299.57it/s]load dataset:   8%|▊         | 121/1512 [00:00<00:05, 274.68it/s]load dataset:  10%|▉         | 149/1512 [00:00<00:05, 266.13it/s]load dataset:  12%|█▏        | 179/1512 [00:00<00:05, 261.40it/s]load dataset:  14%|█▎        | 206/1512 [00:00<00:05, 236.53it/s]load dataset:  17%|█▋        | 255/1512 [00:00<00:04, 305.85it/s]load dataset:  20%|██        | 305/1512 [00:01<00:03, 360.35it/s]load dataset:  23%|██▎       | 347/1512 [00:01<00:03, 375.80it/s]load dataset:  26%|██▌       | 395/1512 [00:01<00:02, 405.00it/s]load dataset:  29%|██▉       | 437/1512 [00:01<00:03, 350.72it/s]load dataset:  32%|███▏      | 480/1512 [00:01<00:02, 368.39it/s]load dataset:  36%|███▌      | 541/1512 [00:01<00:02, 430.47it/s]load dataset:  39%|███▉      | 586/1512 [00:01<00:02, 420.61it/s]load dataset:  42%|████▏     | 630/1512 [00:01<00:02, 418.18it/s]load dataset:  45%|████▍     | 673/1512 [00:01<00:02, 341.14it/s]load dataset:  47%|████▋     | 710/1512 [00:02<00:02, 289.31it/s]load dataset:  49%|████▉     | 745/1512 [00:02<00:02, 301.44it/s]load dataset:  52%|█████▏    | 782/1512 [00:02<00:02, 314.70it/s]load dataset:  54%|█████▍    | 816/1512 [00:02<00:02, 267.99it/s]load dataset:  56%|█████▌    | 846/1512 [00:02<00:02, 271.03it/s]load dataset:  58%|█████▊    | 880/1512 [00:02<00:02, 286.99it/s]load dataset:  60%|██████    | 911/1512 [00:02<00:02, 265.02it/s]load dataset:  64%|██████▍   | 965/1512 [00:02<00:01, 333.32it/s]load dataset:  66%|██████▋   | 1004/1512 [00:03<00:01, 346.82it/s]load dataset:  69%|██████▉   | 1041/1512 [00:03<00:01, 282.38it/s]load dataset:  71%|███████   | 1076/1512 [00:03<00:01, 290.54it/s]load dataset:  73%|███████▎  | 1108/1512 [00:03<00:01, 230.72it/s]load dataset:  75%|███████▌  | 1137/1512 [00:03<00:01, 235.08it/s]load dataset:  78%|███████▊  | 1173/1512 [00:03<00:01, 262.34it/s]load dataset:  80%|████████  | 1211/1512 [00:03<00:01, 290.63it/s]load dataset:  83%|████████▎ | 1254/1512 [00:04<00:00, 324.72it/s]load dataset:  85%|████████▌ | 1289/1512 [00:04<00:00, 330.87it/s]load dataset:  88%|████████▊ | 1324/1512 [00:04<00:00, 312.83it/s]load dataset:  90%|████████▉ | 1357/1512 [00:04<00:00, 310.33it/s]load dataset:  92%|█████████▏| 1397/1512 [00:04<00:00, 333.64it/s]load dataset:  95%|█████████▍| 1432/1512 [00:04<00:00, 285.77it/s]load dataset:  97%|█████████▋| 1466/1512 [00:04<00:00, 299.17it/s]load dataset:  99%|█████████▉| 1498/1512 [00:04<00:00, 223.00it/s]load dataset: 100%|██████████| 1512/1512 [00:05<00:00, 299.86it/s]
08/19/2022 09:46:45 - INFO - __main__ -   ***** Running Test *****
08/19/2022 09:46:45 - INFO - __main__ -     Num examples = 1512
08/19/2022 09:46:45 - INFO - __main__ -     Batch size = 4
evaluate test:   0%|          | 0/378 [00:00<?, ?it/s]evaluate test:   0%|          | 1/378 [00:01<06:50,  1.09s/it]evaluate test:   1%|          | 4/378 [00:01<01:28,  4.21it/s]evaluate test:   2%|▏         | 7/378 [00:01<00:48,  7.67it/s]evaluate test:   3%|▎         | 10/378 [00:01<00:33, 11.03it/s]evaluate test:   3%|▎         | 13/378 [00:01<00:25, 14.15it/s]evaluate test:   4%|▍         | 16/378 [00:01<00:21, 16.87it/s]evaluate test:   5%|▌         | 19/378 [00:01<00:18, 19.18it/s]evaluate test:   6%|▌         | 22/378 [00:01<00:16, 20.99it/s]evaluate test:   7%|▋         | 25/378 [00:02<00:15, 22.26it/s]evaluate test:   7%|▋         | 28/378 [00:02<00:17, 20.08it/s]evaluate test:   8%|▊         | 31/378 [00:02<00:16, 20.70it/s]evaluate test:   9%|▉         | 34/378 [00:02<00:15, 21.98it/s]evaluate test:  10%|▉         | 37/378 [00:02<00:14, 22.99it/s]evaluate test:  11%|█         | 40/378 [00:02<00:14, 23.92it/s]evaluate test:  11%|█▏        | 43/378 [00:02<00:13, 24.57it/s]evaluate test:  12%|█▏        | 46/378 [00:02<00:13, 24.93it/s]evaluate test:  13%|█▎        | 49/378 [00:03<00:13, 25.13it/s]evaluate test:  14%|█▍        | 52/378 [00:03<00:12, 25.31it/s]evaluate test:  15%|█▍        | 55/378 [00:03<00:12, 25.02it/s]evaluate test:  15%|█▌        | 58/378 [00:03<00:13, 24.00it/s]evaluate test:  16%|█▌        | 61/378 [00:03<00:12, 24.45it/s]evaluate test:  17%|█▋        | 64/378 [00:03<00:12, 24.50it/s]evaluate test:  18%|█▊        | 67/378 [00:03<00:12, 24.60it/s]evaluate test:  19%|█▊        | 70/378 [00:03<00:12, 25.02it/s]evaluate test:  19%|█▉        | 73/378 [00:03<00:12, 25.36it/s]evaluate test:  20%|██        | 76/378 [00:04<00:11, 25.67it/s]evaluate test:  21%|██        | 79/378 [00:04<00:11, 25.84it/s]evaluate test:  22%|██▏       | 82/378 [00:04<00:13, 22.58it/s]evaluate test:  22%|██▏       | 85/378 [00:04<00:12, 23.23it/s]evaluate test:  23%|██▎       | 88/378 [00:04<00:12, 23.69it/s]evaluate test:  24%|██▍       | 91/378 [00:04<00:11, 24.00it/s]evaluate test:  25%|██▍       | 94/378 [00:04<00:11, 24.34it/s]evaluate test:  26%|██▌       | 97/378 [00:04<00:11, 24.67it/s]evaluate test:  26%|██▋       | 100/378 [00:05<00:11, 24.95it/s]evaluate test:  27%|██▋       | 103/378 [00:05<00:10, 25.18it/s]evaluate test:  28%|██▊       | 106/378 [00:05<00:10, 25.13it/s]evaluate test:  29%|██▉       | 109/378 [00:05<00:10, 25.11it/s]evaluate test:  30%|██▉       | 112/378 [00:05<00:10, 25.16it/s]evaluate test:  30%|███       | 115/378 [00:05<00:10, 25.48it/s]evaluate test:  31%|███       | 118/378 [00:05<00:10, 25.22it/s]evaluate test:  32%|███▏      | 121/378 [00:05<00:10, 25.20it/s]evaluate test:  33%|███▎      | 124/378 [00:06<00:10, 25.12it/s]evaluate test:  34%|███▎      | 127/378 [00:06<00:09, 25.46it/s]evaluate test:  34%|███▍      | 130/378 [00:06<00:09, 25.63it/s]evaluate test:  35%|███▌      | 133/378 [00:06<00:09, 25.76it/s]evaluate test:  36%|███▌      | 136/378 [00:06<00:09, 25.83it/s]evaluate test:  37%|███▋      | 139/378 [00:06<00:10, 22.87it/s]evaluate test:  38%|███▊      | 142/378 [00:06<00:10, 23.56it/s]evaluate test:  38%|███▊      | 145/378 [00:06<00:09, 23.98it/s]evaluate test:  39%|███▉      | 148/378 [00:07<00:09, 24.40it/s]evaluate test:  40%|███▉      | 151/378 [00:07<00:09, 24.60it/s]evaluate test:  41%|████      | 154/378 [00:07<00:09, 24.80it/s]evaluate test:  42%|████▏     | 157/378 [00:07<00:08, 25.05it/s]evaluate test:  42%|████▏     | 160/378 [00:07<00:08, 25.17it/s]evaluate test:  43%|████▎     | 163/378 [00:07<00:08, 25.32it/s]evaluate test:  44%|████▍     | 166/378 [00:07<00:08, 25.45it/s]evaluate test:  45%|████▍     | 169/378 [00:07<00:08, 25.34it/s]evaluate test:  46%|████▌     | 172/378 [00:07<00:08, 25.33it/s]evaluate test:  46%|████▋     | 175/378 [00:08<00:07, 25.56it/s]evaluate test:  47%|████▋     | 178/378 [00:08<00:07, 25.77it/s]evaluate test:  48%|████▊     | 181/378 [00:08<00:07, 25.50it/s]evaluate test:  49%|████▊     | 184/378 [00:08<00:07, 24.62it/s]evaluate test:  49%|████▉     | 187/378 [00:08<00:07, 24.79it/s]evaluate test:  50%|█████     | 190/378 [00:08<00:07, 25.00it/s]evaluate test:  51%|█████     | 193/378 [00:08<00:07, 25.09it/s]evaluate test:  52%|█████▏    | 196/378 [00:08<00:07, 25.11it/s]evaluate test:  53%|█████▎    | 199/378 [00:09<00:07, 22.68it/s]evaluate test:  53%|█████▎    | 202/378 [00:09<00:07, 23.18it/s]evaluate test:  54%|█████▍    | 205/378 [00:09<00:07, 23.65it/s]evaluate test:  55%|█████▌    | 208/378 [00:09<00:07, 24.26it/s]evaluate test:  56%|█████▌    | 211/378 [00:09<00:06, 24.42it/s]evaluate test:  57%|█████▋    | 214/378 [00:09<00:06, 24.63it/s]evaluate test:  57%|█████▋    | 217/378 [00:09<00:06, 25.11it/s]evaluate test:  58%|█████▊    | 220/378 [00:09<00:06, 25.38it/s]evaluate test:  59%|█████▉    | 223/378 [00:10<00:06, 25.34it/s]evaluate test:  60%|█████▉    | 226/378 [00:10<00:05, 25.63it/s]evaluate test:  61%|██████    | 229/378 [00:10<00:05, 25.72it/s]evaluate test:  61%|██████▏   | 232/378 [00:10<00:05, 25.71it/s]evaluate test:  62%|██████▏   | 235/378 [00:10<00:05, 25.79it/s]evaluate test:  63%|██████▎   | 238/378 [00:10<00:05, 25.60it/s]evaluate test:  64%|██████▍   | 241/378 [00:10<00:05, 25.31it/s]evaluate test:  65%|██████▍   | 244/378 [00:10<00:05, 25.16it/s]evaluate test:  65%|██████▌   | 247/378 [00:10<00:05, 25.42it/s]evaluate test:  66%|██████▌   | 250/378 [00:11<00:05, 25.47it/s]evaluate test:  67%|██████▋   | 253/378 [00:11<00:05, 22.47it/s]evaluate test:  68%|██████▊   | 256/378 [00:11<00:05, 22.73it/s]evaluate test:  69%|██████▊   | 259/378 [00:11<00:05, 23.22it/s]evaluate test:  69%|██████▉   | 262/378 [00:11<00:04, 23.60it/s]evaluate test:  70%|███████   | 265/378 [00:11<00:04, 24.21it/s]evaluate test:  71%|███████   | 268/378 [00:11<00:04, 24.67it/s]evaluate test:  72%|███████▏  | 271/378 [00:12<00:04, 24.83it/s]evaluate test:  72%|███████▏  | 274/378 [00:12<00:04, 24.69it/s]evaluate test:  73%|███████▎  | 277/378 [00:12<00:04, 24.74it/s]evaluate test:  74%|███████▍  | 280/378 [00:12<00:03, 25.06it/s]evaluate test:  75%|███████▍  | 283/378 [00:12<00:03, 24.78it/s]evaluate test:  76%|███████▌  | 286/378 [00:12<00:03, 24.65it/s]evaluate test:  76%|███████▋  | 289/378 [00:12<00:03, 24.70it/s]evaluate test:  77%|███████▋  | 292/378 [00:12<00:03, 24.73it/s]evaluate test:  78%|███████▊  | 295/378 [00:12<00:03, 24.70it/s]evaluate test:  79%|███████▉  | 298/378 [00:13<00:03, 24.64it/s]evaluate test:  80%|███████▉  | 301/378 [00:13<00:03, 24.17it/s]evaluate test:  80%|████████  | 304/378 [00:13<00:03, 23.94it/s]evaluate test:  81%|████████  | 307/378 [00:13<00:02, 24.04it/s]evaluate test:  82%|████████▏ | 310/378 [00:13<00:03, 22.62it/s]evaluate test:  83%|████████▎ | 313/378 [00:13<00:03, 20.79it/s]evaluate test:  84%|████████▎ | 316/378 [00:13<00:02, 21.92it/s]evaluate test:  84%|████████▍ | 319/378 [00:14<00:02, 22.65it/s]evaluate test:  85%|████████▌ | 322/378 [00:14<00:02, 23.14it/s]evaluate test:  86%|████████▌ | 325/378 [00:14<00:02, 23.43it/s]evaluate test:  87%|████████▋ | 328/378 [00:14<00:02, 23.72it/s]evaluate test:  88%|████████▊ | 331/378 [00:14<00:01, 23.72it/s]evaluate test:  88%|████████▊ | 334/378 [00:14<00:01, 24.07it/s]evaluate test:  89%|████████▉ | 337/378 [00:14<00:01, 24.20it/s]evaluate test:  90%|████████▉ | 340/378 [00:14<00:01, 24.48it/s]evaluate test:  91%|█████████ | 343/378 [00:15<00:01, 24.27it/s]evaluate test:  92%|█████████▏| 346/378 [00:15<00:01, 24.49it/s]evaluate test:  92%|█████████▏| 349/378 [00:15<00:01, 24.86it/s]evaluate test:  93%|█████████▎| 352/378 [00:15<00:01, 24.82it/s]evaluate test:  94%|█████████▍| 355/378 [00:15<00:00, 24.90it/s]evaluate test:  95%|█████████▍| 358/378 [00:15<00:00, 24.85it/s]evaluate test:  96%|█████████▌| 361/378 [00:15<00:00, 23.18it/s]evaluate test:  96%|█████████▋| 364/378 [00:15<00:00, 23.14it/s]evaluate test:  97%|█████████▋| 367/378 [00:16<00:00, 23.75it/s]evaluate test:  98%|█████████▊| 370/378 [00:16<00:00, 24.44it/s]evaluate test:  99%|█████████▊| 373/378 [00:16<00:00, 25.00it/s]evaluate test:  99%|█████████▉| 376/378 [00:16<00:00, 25.10it/s]evaluate test: 100%|██████████| 378/378 [00:16<00:00, 22.98it/s]
08/19/2022 09:47:01 - INFO - __main__ -   ***** Test results *****
08/19/2022 09:47:01 - INFO - __main__ -     test_accuracy = 0.9775
08/19/2022 09:47:01 - INFO - __main__ -     test_f1 = 0.8191
08/19/2022 09:47:01 - INFO - __main__ -     test_precision = 0.8021
08/19/2022 09:47:01 - INFO - __main__ -     test_recall = 0.837
08/19/2022 09:47:01 - INFO - __main__ -     test_threshold = 0.5
