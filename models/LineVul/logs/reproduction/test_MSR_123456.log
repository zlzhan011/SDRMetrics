08/03/2022 08:51:56 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of the model checkpoint at microsoft/codebert-base were not used when initializing RobertaForSequenceClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/03/2022 08:52:02 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/big-vul_dataset/train.csv', output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file='../data/big-vul_dataset/val.csv', test_data_file='../data/big-vul_dataset/test.csv', model_name='12heads_linevul_model.bin', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=512, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
  0%|          | 0/18864 [00:00<?, ?it/s]  0%|          | 65/18864 [00:00<00:29, 646.68it/s]  1%|          | 130/18864 [00:00<00:30, 614.51it/s]  1%|          | 192/18864 [00:00<00:31, 586.36it/s]  1%|▏         | 251/18864 [00:00<00:34, 535.98it/s]  2%|▏         | 310/18864 [00:00<00:33, 553.42it/s]  2%|▏         | 366/18864 [00:00<00:33, 547.93it/s]  2%|▏         | 422/18864 [00:00<00:33, 550.95it/s]  3%|▎         | 486/18864 [00:00<00:31, 577.97it/s]  3%|▎         | 548/18864 [00:00<00:33, 550.03it/s]  3%|▎         | 604/18864 [00:01<00:34, 531.04it/s]  3%|▎         | 659/18864 [00:01<00:33, 536.30it/s]  4%|▍         | 729/18864 [00:01<00:31, 580.76it/s]  4%|▍         | 798/18864 [00:01<00:34, 516.34it/s]  5%|▍         | 857/18864 [00:01<00:33, 535.25it/s]  5%|▍         | 920/18864 [00:01<00:32, 559.71it/s]  5%|▌         | 978/18864 [00:01<00:36, 485.63it/s]  6%|▌         | 1060/18864 [00:01<00:31, 569.50it/s]  6%|▌         | 1129/18864 [00:02<00:29, 599.27it/s]  6%|▋         | 1197/18864 [00:02<00:29, 603.62it/s]  7%|▋         | 1275/18864 [00:02<00:27, 650.16it/s]  7%|▋         | 1355/18864 [00:02<00:25, 690.54it/s]  8%|▊         | 1426/18864 [00:02<00:26, 652.59it/s]  8%|▊         | 1493/18864 [00:02<00:27, 639.97it/s]  8%|▊         | 1564/18864 [00:02<00:27, 640.08it/s]  9%|▊         | 1635/18864 [00:02<00:26, 658.80it/s]  9%|▉         | 1710/18864 [00:02<00:25, 683.65it/s]  9%|▉         | 1786/18864 [00:02<00:24, 704.66it/s] 10%|▉         | 1868/18864 [00:03<00:23, 736.72it/s] 10%|█         | 1943/18864 [00:03<00:23, 709.12it/s] 11%|█         | 2029/18864 [00:03<00:22, 737.11it/s] 11%|█         | 2110/18864 [00:03<00:22, 751.30it/s] 12%|█▏        | 2187/18864 [00:03<00:22, 743.47it/s] 12%|█▏        | 2262/18864 [00:03<00:22, 744.88it/s] 12%|█▏        | 2337/18864 [00:03<00:23, 695.26it/s] 13%|█▎        | 2408/18864 [00:03<00:23, 691.24it/s] 13%|█▎        | 2478/18864 [00:03<00:25, 646.13it/s] 13%|█▎        | 2544/18864 [00:04<00:26, 608.19it/s] 14%|█▍        | 2606/18864 [00:04<00:28, 564.18it/s] 14%|█▍        | 2664/18864 [00:04<00:29, 556.16it/s] 15%|█▍        | 2749/18864 [00:04<00:25, 633.75it/s] 15%|█▍        | 2816/18864 [00:04<00:25, 639.77it/s] 15%|█▌        | 2881/18864 [00:04<00:26, 603.56it/s] 16%|█▌        | 2947/18864 [00:04<00:25, 618.98it/s] 16%|█▌        | 3023/18864 [00:04<00:24, 650.29it/s] 16%|█▋        | 3094/18864 [00:04<00:24, 643.58it/s] 17%|█▋        | 3159/18864 [00:05<00:24, 628.27it/s] 17%|█▋        | 3223/18864 [00:05<00:25, 617.22it/s] 17%|█▋        | 3297/18864 [00:05<00:24, 645.95it/s] 18%|█▊        | 3368/18864 [00:05<00:23, 661.65it/s] 18%|█▊        | 3436/18864 [00:05<00:23, 666.88it/s] 19%|█▊        | 3510/18864 [00:05<00:22, 684.18it/s] 19%|█▉        | 3579/18864 [00:05<00:24, 611.64it/s] 19%|█▉        | 3642/18864 [00:05<00:25, 593.18it/s] 20%|█▉        | 3703/18864 [00:05<00:26, 575.49it/s] 20%|█▉        | 3762/18864 [00:06<00:26, 579.30it/s] 20%|██        | 3823/18864 [00:06<00:25, 586.39it/s] 21%|██        | 3888/18864 [00:06<00:24, 604.15it/s] 21%|██        | 3986/18864 [00:06<00:21, 697.95it/s] 22%|██▏       | 4056/18864 [00:06<00:21, 696.86it/s] 22%|██▏       | 4126/18864 [00:06<00:21, 695.35it/s] 22%|██▏       | 4196/18864 [00:06<00:21, 690.60it/s] 23%|██▎       | 4266/18864 [00:06<00:22, 656.37it/s] 23%|██▎       | 4335/18864 [00:06<00:21, 663.87it/s] 23%|██▎       | 4402/18864 [00:07<00:26, 550.60it/s] 24%|██▍       | 4505/18864 [00:07<00:21, 670.80it/s] 24%|██▍       | 4591/18864 [00:07<00:19, 720.02it/s] 25%|██▍       | 4667/18864 [00:07<00:24, 590.34it/s] 25%|██▌       | 4741/18864 [00:07<00:22, 626.26it/s] 25%|██▌       | 4809/18864 [00:07<00:22, 626.71it/s] 26%|██▌       | 4876/18864 [00:07<00:21, 635.91it/s] 26%|██▌       | 4948/18864 [00:07<00:21, 658.33it/s] 27%|██▋       | 5039/18864 [00:07<00:19, 721.46it/s] 27%|██▋       | 5122/18864 [00:08<00:18, 739.42it/s] 28%|██▊       | 5198/18864 [00:08<00:22, 619.11it/s] 28%|██▊       | 5285/18864 [00:08<00:19, 680.66it/s] 28%|██▊       | 5357/18864 [00:08<00:20, 657.18it/s] 29%|██▉       | 5431/18864 [00:08<00:19, 673.52it/s] 29%|██▉       | 5503/18864 [00:08<00:19, 680.50it/s] 30%|██▉       | 5582/18864 [00:08<00:18, 709.86it/s] 30%|██▉       | 5659/18864 [00:08<00:18, 726.18it/s] 30%|███       | 5733/18864 [00:09<00:19, 674.43it/s] 31%|███       | 5820/18864 [00:09<00:18, 706.58it/s] 31%|███       | 5892/18864 [00:09<00:19, 672.24it/s] 32%|███▏      | 5961/18864 [00:09<00:20, 638.49it/s] 32%|███▏      | 6040/18864 [00:09<00:18, 678.83it/s] 32%|███▏      | 6109/18864 [00:09<00:19, 666.49it/s] 33%|███▎      | 6177/18864 [00:09<00:19, 645.58it/s] 33%|███▎      | 6262/18864 [00:09<00:18, 698.25it/s] 34%|███▎      | 6333/18864 [00:09<00:17, 699.54it/s] 34%|███▍      | 6408/18864 [00:09<00:17, 711.60it/s] 34%|███▍      | 6480/18864 [00:10<00:17, 710.68it/s] 35%|███▍      | 6552/18864 [00:10<00:17, 708.03it/s] 35%|███▌      | 6623/18864 [00:10<00:18, 674.44it/s] 35%|███▌      | 6691/18864 [00:10<00:18, 653.83it/s] 36%|███▌      | 6765/18864 [00:10<00:18, 671.63it/s] 36%|███▌      | 6833/18864 [00:10<00:18, 661.40it/s] 37%|███▋      | 6900/18864 [00:10<00:20, 593.21it/s] 37%|███▋      | 6968/18864 [00:10<00:19, 612.79it/s] 37%|███▋      | 7031/18864 [00:10<00:19, 592.09it/s] 38%|███▊      | 7092/18864 [00:11<00:20, 587.86it/s] 38%|███▊      | 7154/18864 [00:11<00:19, 595.05it/s] 38%|███▊      | 7214/18864 [00:11<00:23, 500.40it/s] 39%|███▊      | 7284/18864 [00:11<00:21, 549.27it/s] 39%|███▉      | 7342/18864 [00:11<00:21, 544.30it/s] 39%|███▉      | 7399/18864 [00:11<00:20, 546.21it/s] 40%|███▉      | 7455/18864 [00:11<00:21, 538.05it/s] 40%|███▉      | 7526/18864 [00:11<00:19, 583.10it/s] 40%|████      | 7592/18864 [00:11<00:18, 604.46it/s] 41%|████      | 7669/18864 [00:12<00:17, 651.10it/s] 41%|████      | 7735/18864 [00:12<00:18, 599.20it/s] 41%|████▏     | 7818/18864 [00:12<00:16, 662.08it/s] 42%|████▏     | 7886/18864 [00:12<00:17, 624.47it/s] 42%|████▏     | 7950/18864 [00:12<00:18, 590.49it/s] 43%|████▎     | 8023/18864 [00:12<00:17, 627.92it/s] 43%|████▎     | 8087/18864 [00:12<00:17, 607.08it/s] 43%|████▎     | 8153/18864 [00:12<00:18, 593.20it/s] 44%|████▎     | 8243/18864 [00:13<00:15, 675.56it/s] 44%|████▍     | 8312/18864 [00:13<00:15, 660.15it/s] 44%|████▍     | 8387/18864 [00:13<00:15, 682.05it/s] 45%|████▍     | 8478/18864 [00:13<00:13, 746.74it/s] 45%|████▌     | 8554/18864 [00:13<00:15, 666.23it/s] 46%|████▌     | 8640/18864 [00:13<00:14, 712.23it/s] 46%|████▌     | 8714/18864 [00:13<00:14, 703.61it/s] 47%|████▋     | 8786/18864 [00:13<00:14, 707.31it/s] 47%|████▋     | 8861/18864 [00:13<00:14, 713.59it/s] 47%|████▋     | 8934/18864 [00:13<00:13, 716.73it/s] 48%|████▊     | 9007/18864 [00:14<00:15, 651.85it/s] 48%|████▊     | 9078/18864 [00:14<00:14, 666.09it/s] 48%|████▊     | 9146/18864 [00:14<00:14, 669.27it/s] 49%|████▉     | 9214/18864 [00:14<00:16, 600.44it/s] 49%|████▉     | 9288/18864 [00:14<00:15, 636.86it/s] 50%|████▉     | 9366/18864 [00:14<00:14, 675.20it/s] 50%|█████     | 9441/18864 [00:14<00:13, 684.45it/s] 50%|█████     | 9511/18864 [00:14<00:13, 674.60it/s] 51%|█████     | 9589/18864 [00:14<00:13, 704.55it/s] 51%|█████     | 9661/18864 [00:15<00:13, 704.14it/s] 52%|█████▏    | 9755/18864 [00:15<00:11, 771.56it/s] 52%|█████▏    | 9839/18864 [00:15<00:11, 788.13it/s] 53%|█████▎    | 9924/18864 [00:15<00:11, 805.38it/s] 53%|█████▎    | 10005/18864 [00:15<00:14, 631.85it/s] 53%|█████▎    | 10075/18864 [00:15<00:14, 587.86it/s] 54%|█████▎    | 10139/18864 [00:15<00:14, 590.54it/s] 54%|█████▍    | 10209/18864 [00:15<00:13, 618.30it/s] 54%|█████▍    | 10276/18864 [00:16<00:13, 631.95it/s] 55%|█████▍    | 10342/18864 [00:16<00:15, 540.34it/s] 55%|█████▌    | 10400/18864 [00:16<00:15, 542.63it/s] 56%|█████▌    | 10483/18864 [00:16<00:13, 616.54it/s] 56%|█████▌    | 10549/18864 [00:16<00:13, 627.73it/s] 56%|█████▋    | 10615/18864 [00:16<00:12, 636.35it/s] 57%|█████▋    | 10685/18864 [00:16<00:12, 648.76it/s] 57%|█████▋    | 10778/18864 [00:16<00:11, 729.11it/s] 58%|█████▊    | 10853/18864 [00:16<00:13, 593.00it/s] 58%|█████▊    | 10918/18864 [00:17<00:13, 601.16it/s] 58%|█████▊    | 10982/18864 [00:17<00:13, 594.22it/s] 59%|█████▊    | 11062/18864 [00:17<00:12, 647.12it/s] 59%|█████▉    | 11130/18864 [00:17<00:11, 647.47it/s] 59%|█████▉    | 11205/18864 [00:17<00:11, 676.02it/s] 60%|█████▉    | 11284/18864 [00:17<00:10, 708.18it/s] 60%|██████    | 11356/18864 [00:17<00:10, 702.66it/s] 61%|██████    | 11439/18864 [00:17<00:10, 739.54it/s] 61%|██████    | 11514/18864 [00:18<00:15, 477.12it/s] 61%|██████▏   | 11586/18864 [00:18<00:13, 527.29it/s] 62%|██████▏   | 11662/18864 [00:18<00:12, 580.76it/s] 62%|██████▏   | 11730/18864 [00:18<00:11, 603.61it/s] 63%|██████▎   | 11798/18864 [00:18<00:11, 616.01it/s] 63%|██████▎   | 11868/18864 [00:18<00:10, 637.75it/s] 63%|██████▎   | 11936/18864 [00:18<00:13, 516.80it/s] 64%|██████▎   | 12004/18864 [00:18<00:12, 554.20it/s] 64%|██████▍   | 12071/18864 [00:18<00:11, 581.76it/s] 64%|██████▍   | 12139/18864 [00:19<00:11, 606.75it/s] 65%|██████▍   | 12219/18864 [00:19<00:10, 657.23it/s] 65%|██████▌   | 12288/18864 [00:19<00:09, 659.65it/s] 66%|██████▌   | 12359/18864 [00:19<00:09, 672.75it/s] 66%|██████▌   | 12431/18864 [00:19<00:09, 658.49it/s] 66%|██████▋   | 12498/18864 [00:19<00:09, 655.46it/s] 67%|██████▋   | 12577/18864 [00:19<00:09, 680.08it/s] 67%|██████▋   | 12660/18864 [00:19<00:08, 722.52it/s] 67%|██████▋   | 12733/18864 [00:19<00:08, 682.92it/s] 68%|██████▊   | 12831/18864 [00:20<00:07, 764.89it/s] 68%|██████▊   | 12909/18864 [00:20<00:08, 705.47it/s] 69%|██████▉   | 12989/18864 [00:20<00:08, 730.31it/s] 69%|██████▉   | 13064/18864 [00:20<00:08, 715.35it/s] 70%|██████▉   | 13154/18864 [00:20<00:07, 766.07it/s] 70%|███████   | 13232/18864 [00:20<00:08, 687.34it/s] 71%|███████   | 13319/18864 [00:20<00:07, 734.66it/s] 71%|███████   | 13395/18864 [00:20<00:07, 698.50it/s] 71%|███████▏  | 13467/18864 [00:20<00:08, 645.37it/s] 72%|███████▏  | 13534/18864 [00:21<00:08, 613.37it/s] 72%|███████▏  | 13602/18864 [00:21<00:08, 630.49it/s] 73%|███████▎  | 13688/18864 [00:21<00:07, 678.01it/s] 73%|███████▎  | 13758/18864 [00:21<00:07, 682.34it/s] 73%|███████▎  | 13850/18864 [00:21<00:06, 743.96it/s] 74%|███████▍  | 13926/18864 [00:21<00:06, 710.32it/s] 74%|███████▍  | 14004/18864 [00:21<00:06, 728.42it/s] 75%|███████▍  | 14093/18864 [00:21<00:06, 774.14it/s] 75%|███████▌  | 14172/18864 [00:21<00:06, 733.62it/s] 76%|███████▌  | 14247/18864 [00:22<00:06, 707.67it/s] 76%|███████▌  | 14322/18864 [00:22<00:06, 719.21it/s] 76%|███████▋  | 14406/18864 [00:22<00:05, 752.04it/s] 77%|███████▋  | 14489/18864 [00:22<00:05, 772.16it/s] 77%|███████▋  | 14567/18864 [00:22<00:05, 738.97it/s] 78%|███████▊  | 14642/18864 [00:22<00:06, 645.59it/s] 78%|███████▊  | 14719/18864 [00:22<00:06, 675.34it/s] 78%|███████▊  | 14806/18864 [00:22<00:05, 726.95it/s] 79%|███████▉  | 14882/18864 [00:22<00:05, 731.10it/s] 79%|███████▉  | 14957/18864 [00:23<00:05, 710.55it/s] 80%|███████▉  | 15030/18864 [00:23<00:05, 709.25it/s] 80%|████████  | 15103/18864 [00:23<00:05, 703.22it/s] 81%|████████  | 15192/18864 [00:23<00:04, 754.20it/s] 81%|████████  | 15270/18864 [00:23<00:04, 759.38it/s] 81%|████████▏ | 15347/18864 [00:23<00:04, 727.99it/s] 82%|████████▏ | 15421/18864 [00:23<00:04, 718.72it/s] 82%|████████▏ | 15494/18864 [00:23<00:04, 685.39it/s] 83%|████████▎ | 15564/18864 [00:23<00:04, 688.53it/s] 83%|████████▎ | 15662/18864 [00:24<00:04, 757.66it/s] 83%|████████▎ | 15739/18864 [00:24<00:04, 760.28it/s] 84%|████████▍ | 15831/18864 [00:24<00:03, 801.26it/s] 84%|████████▍ | 15918/18864 [00:24<00:03, 817.60it/s] 85%|████████▍ | 16002/18864 [00:24<00:03, 823.03it/s] 85%|████████▌ | 16085/18864 [00:24<00:03, 788.57it/s] 86%|████████▌ | 16165/18864 [00:24<00:04, 553.77it/s] 86%|████████▌ | 16251/18864 [00:24<00:04, 621.27it/s] 87%|████████▋ | 16323/18864 [00:25<00:03, 639.36it/s] 87%|████████▋ | 16398/18864 [00:25<00:03, 665.98it/s] 87%|████████▋ | 16483/18864 [00:25<00:03, 714.92it/s] 88%|████████▊ | 16577/18864 [00:25<00:02, 775.15it/s] 88%|████████▊ | 16658/18864 [00:25<00:02, 772.48it/s] 89%|████████▉ | 16746/18864 [00:25<00:02, 802.41it/s] 89%|████████▉ | 16829/18864 [00:25<00:02, 795.68it/s] 90%|████████▉ | 16910/18864 [00:25<00:02, 750.72it/s] 90%|█████████ | 17001/18864 [00:25<00:02, 794.34it/s] 91%|█████████ | 17096/18864 [00:25<00:02, 836.61it/s] 91%|█████████ | 17181/18864 [00:26<00:02, 745.82it/s] 92%|█████████▏| 17277/18864 [00:26<00:01, 794.45it/s] 92%|█████████▏| 17359/18864 [00:26<00:01, 797.07it/s] 92%|█████████▏| 17441/18864 [00:26<00:01, 780.54it/s] 93%|█████████▎| 17521/18864 [00:26<00:01, 739.35it/s] 93%|█████████▎| 17596/18864 [00:26<00:01, 708.03it/s] 94%|█████████▎| 17668/18864 [00:26<00:01, 635.02it/s] 94%|█████████▍| 17734/18864 [00:26<00:01, 611.62it/s] 94%|█████████▍| 17815/18864 [00:27<00:01, 662.77it/s] 95%|█████████▍| 17883/18864 [00:27<00:01, 635.78it/s] 95%|█████████▌| 17955/18864 [00:27<00:01, 655.23it/s] 96%|█████████▌| 18022/18864 [00:27<00:01, 651.42it/s] 96%|█████████▌| 18088/18864 [00:27<00:01, 649.58it/s] 96%|█████████▌| 18154/18864 [00:27<00:01, 567.57it/s] 97%|█████████▋| 18213/18864 [00:27<00:01, 556.71it/s] 97%|█████████▋| 18293/18864 [00:27<00:00, 620.16it/s] 97%|█████████▋| 18381/18864 [00:27<00:00, 690.69it/s] 98%|█████████▊| 18452/18864 [00:28<00:00, 668.33it/s] 98%|█████████▊| 18521/18864 [00:28<00:00, 605.10it/s] 99%|█████████▊| 18590/18864 [00:28<00:00, 623.93it/s] 99%|█████████▉| 18654/18864 [00:28<00:00, 564.57it/s] 99%|█████████▉| 18739/18864 [00:28<00:00, 637.08it/s]100%|█████████▉| 18806/18864 [00:28<00:00, 605.19it/s]100%|██████████| 18864/18864 [00:28<00:00, 656.54it/s]
08/03/2022 08:52:40 - INFO - __main__ -   ***** Running Test *****
08/03/2022 08:52:40 - INFO - __main__ -     Num examples = 18864
08/03/2022 08:52:40 - INFO - __main__ -     Batch size = 512
08/03/2022 08:55:00 - INFO - __main__ -   ***** Test results *****
08/03/2022 08:55:00 - INFO - __main__ -     test_accuracy = 0.9909
08/03/2022 08:55:00 - INFO - __main__ -     test_f1 = 0.9142
08/03/2022 08:55:00 - INFO - __main__ -     test_precision = 0.9712
08/03/2022 08:55:00 - INFO - __main__ -     test_recall = 0.8635
08/03/2022 08:55:00 - INFO - __main__ -     test_threshold = 0.5
