08/19/2022 09:48:22 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of the model checkpoint at microsoft/codebert-base were not used when initializing RobertaForSequenceClassification: ['pooler.dense.bias', 'pooler.dense.weight']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight', 'classifier.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/19/2022 09:48:29 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file=None, output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file=None, test_data_file='../data/subsets/bug_type/bugtype_value_propagation_errors/test.csv', model_name='bug_type/bugtype_value_propagation_errors', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=4, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
load dataset:   0%|          | 0/1512 [00:00<?, ?it/s]load dataset:   1%|▏         | 21/1512 [00:00<00:07, 208.87it/s]load dataset:   4%|▍         | 64/1512 [00:00<00:04, 332.80it/s]load dataset:   8%|▊         | 119/1512 [00:00<00:03, 430.81it/s]load dataset:  11%|█▏        | 172/1512 [00:00<00:02, 469.46it/s]load dataset:  14%|█▍        | 219/1512 [00:00<00:03, 343.24it/s]load dataset:  17%|█▋        | 258/1512 [00:00<00:03, 355.08it/s]load dataset:  20%|█▉        | 297/1512 [00:00<00:03, 363.18it/s]load dataset:  23%|██▎       | 355/1512 [00:00<00:02, 424.44it/s]load dataset:  28%|██▊       | 421/1512 [00:01<00:02, 492.11it/s]load dataset:  31%|███▏      | 473/1512 [00:01<00:02, 489.15it/s]load dataset:  35%|███▍      | 527/1512 [00:01<00:01, 502.06it/s]load dataset:  38%|███▊      | 580/1512 [00:01<00:01, 502.91it/s]load dataset:  42%|████▏     | 632/1512 [00:01<00:01, 458.10it/s]load dataset:  45%|████▍     | 680/1512 [00:01<00:02, 405.72it/s]load dataset:  48%|████▊     | 723/1512 [00:01<00:02, 378.70it/s]load dataset:  50%|█████     | 763/1512 [00:01<00:02, 370.74it/s]load dataset:  53%|█████▎    | 801/1512 [00:02<00:02, 281.13it/s]load dataset:  55%|█████▌    | 836/1512 [00:02<00:02, 292.13it/s]load dataset:  57%|█████▋    | 868/1512 [00:02<00:02, 290.87it/s]load dataset:  59%|█████▉    | 899/1512 [00:02<00:02, 283.68it/s]load dataset:  62%|██████▏   | 941/1512 [00:02<00:01, 312.04it/s]load dataset:  64%|██████▍   | 974/1512 [00:02<00:01, 300.46it/s]load dataset:  66%|██████▋   | 1005/1512 [00:02<00:01, 285.78it/s]load dataset:  68%|██████▊   | 1035/1512 [00:02<00:01, 278.46it/s]load dataset:  71%|███████   | 1075/1512 [00:02<00:01, 310.26it/s]load dataset:  73%|███████▎  | 1107/1512 [00:03<00:01, 252.73it/s]load dataset:  77%|███████▋  | 1159/1512 [00:03<00:01, 316.10it/s]load dataset:  80%|████████  | 1211/1512 [00:03<00:00, 367.97it/s]load dataset:  83%|████████▎ | 1260/1512 [00:03<00:00, 397.47it/s]load dataset:  86%|████████▌ | 1303/1512 [00:03<00:00, 394.68it/s]load dataset:  89%|████████▉ | 1346/1512 [00:03<00:00, 403.85it/s]load dataset:  92%|█████████▏| 1388/1512 [00:03<00:00, 395.32it/s]load dataset:  95%|█████████▍| 1430/1512 [00:03<00:00, 334.02it/s]load dataset:  97%|█████████▋| 1466/1512 [00:04<00:00, 282.02it/s]load dataset:  99%|█████████▉| 1497/1512 [00:04<00:00, 203.40it/s]load dataset: 100%|██████████| 1512/1512 [00:04<00:00, 334.80it/s]
08/19/2022 09:48:38 - INFO - __main__ -   ***** Running Test *****
08/19/2022 09:48:38 - INFO - __main__ -     Num examples = 1512
08/19/2022 09:48:38 - INFO - __main__ -     Batch size = 4
evaluate test:   0%|          | 0/378 [00:00<?, ?it/s]evaluate test:   0%|          | 1/378 [00:01<07:41,  1.22s/it]evaluate test:   1%|          | 4/378 [00:01<01:40,  3.72it/s]evaluate test:   2%|▏         | 7/378 [00:01<00:54,  6.84it/s]evaluate test:   3%|▎         | 10/378 [00:01<00:37,  9.94it/s]evaluate test:   3%|▎         | 13/378 [00:01<00:29, 12.48it/s]evaluate test:   4%|▍         | 16/378 [00:01<00:24, 14.94it/s]evaluate test:   5%|▌         | 19/378 [00:01<00:20, 17.23it/s]evaluate test:   6%|▌         | 22/378 [00:02<00:18, 19.20it/s]evaluate test:   7%|▋         | 25/378 [00:02<00:17, 20.43it/s]evaluate test:   7%|▋         | 28/378 [00:02<00:16, 21.57it/s]evaluate test:   8%|▊         | 31/378 [00:02<00:15, 22.25it/s]evaluate test:   9%|▉         | 34/378 [00:02<00:15, 22.88it/s]evaluate test:  10%|▉         | 37/378 [00:02<00:14, 23.38it/s]evaluate test:  11%|█         | 40/378 [00:02<00:14, 23.71it/s]evaluate test:  11%|█▏        | 43/378 [00:02<00:13, 23.94it/s]evaluate test:  12%|█▏        | 46/378 [00:03<00:14, 23.35it/s]evaluate test:  13%|█▎        | 49/378 [00:03<00:13, 23.80it/s]evaluate test:  14%|█▍        | 52/378 [00:03<00:13, 24.38it/s]evaluate test:  15%|█▍        | 55/378 [00:03<00:12, 24.97it/s]evaluate test:  15%|█▌        | 58/378 [00:03<00:14, 22.23it/s]evaluate test:  16%|█▌        | 61/378 [00:03<00:13, 22.88it/s]evaluate test:  17%|█▋        | 64/378 [00:03<00:13, 23.25it/s]evaluate test:  18%|█▊        | 67/378 [00:03<00:13, 23.88it/s]evaluate test:  19%|█▊        | 70/378 [00:04<00:12, 24.45it/s]evaluate test:  19%|█▉        | 73/378 [00:04<00:12, 24.74it/s]evaluate test:  20%|██        | 76/378 [00:04<00:12, 24.12it/s]evaluate test:  21%|██        | 79/378 [00:04<00:12, 24.19it/s]evaluate test:  22%|██▏       | 82/378 [00:04<00:12, 24.24it/s]evaluate test:  22%|██▏       | 85/378 [00:04<00:12, 24.15it/s]evaluate test:  23%|██▎       | 88/378 [00:04<00:11, 24.31it/s]evaluate test:  24%|██▍       | 91/378 [00:04<00:11, 24.39it/s]evaluate test:  25%|██▍       | 94/378 [00:05<00:11, 24.66it/s]evaluate test:  26%|██▌       | 97/378 [00:05<00:11, 24.84it/s]evaluate test:  26%|██▋       | 100/378 [00:05<00:11, 25.03it/s]evaluate test:  27%|██▋       | 103/378 [00:05<00:10, 25.55it/s]evaluate test:  28%|██▊       | 106/378 [00:05<00:10, 25.73it/s]evaluate test:  29%|██▉       | 109/378 [00:05<00:10, 24.68it/s]evaluate test:  30%|██▉       | 112/378 [00:05<00:10, 24.20it/s]evaluate test:  30%|███       | 115/378 [00:05<00:11, 22.39it/s]evaluate test:  31%|███       | 118/378 [00:06<00:11, 23.12it/s]evaluate test:  32%|███▏      | 121/378 [00:06<00:10, 23.80it/s]evaluate test:  33%|███▎      | 124/378 [00:06<00:10, 24.23it/s]evaluate test:  34%|███▎      | 127/378 [00:06<00:10, 24.70it/s]evaluate test:  34%|███▍      | 130/378 [00:06<00:09, 24.88it/s]evaluate test:  35%|███▌      | 133/378 [00:06<00:09, 24.81it/s]evaluate test:  36%|███▌      | 136/378 [00:06<00:09, 25.05it/s]evaluate test:  37%|███▋      | 139/378 [00:06<00:09, 24.23it/s]evaluate test:  38%|███▊      | 142/378 [00:07<00:09, 24.26it/s]evaluate test:  38%|███▊      | 145/378 [00:07<00:09, 24.21it/s]evaluate test:  39%|███▉      | 148/378 [00:07<00:09, 24.60it/s]evaluate test:  40%|███▉      | 151/378 [00:07<00:09, 24.64it/s]evaluate test:  41%|████      | 154/378 [00:07<00:09, 24.81it/s]evaluate test:  42%|████▏     | 157/378 [00:07<00:08, 25.02it/s]evaluate test:  42%|████▏     | 160/378 [00:07<00:08, 25.07it/s]evaluate test:  43%|████▎     | 163/378 [00:07<00:08, 25.10it/s]evaluate test:  44%|████▍     | 166/378 [00:08<00:08, 25.28it/s]evaluate test:  45%|████▍     | 169/378 [00:08<00:08, 25.20it/s]evaluate test:  46%|████▌     | 172/378 [00:08<00:09, 21.86it/s]evaluate test:  46%|████▋     | 175/378 [00:08<00:09, 22.31it/s]evaluate test:  47%|████▋     | 178/378 [00:08<00:08, 22.68it/s]evaluate test:  48%|████▊     | 181/378 [00:08<00:08, 23.42it/s]evaluate test:  49%|████▊     | 184/378 [00:08<00:08, 23.85it/s]evaluate test:  49%|████▉     | 187/378 [00:08<00:07, 24.30it/s]evaluate test:  50%|█████     | 190/378 [00:09<00:07, 24.36it/s]evaluate test:  51%|█████     | 193/378 [00:09<00:07, 24.70it/s]evaluate test:  52%|█████▏    | 196/378 [00:09<00:07, 25.08it/s]evaluate test:  53%|█████▎    | 199/378 [00:09<00:07, 25.41it/s]evaluate test:  53%|█████▎    | 202/378 [00:09<00:07, 24.22it/s]evaluate test:  54%|█████▍    | 205/378 [00:09<00:07, 24.04it/s]evaluate test:  55%|█████▌    | 208/378 [00:09<00:07, 24.22it/s]evaluate test:  56%|█████▌    | 211/378 [00:09<00:06, 24.11it/s]evaluate test:  57%|█████▋    | 214/378 [00:10<00:06, 24.41it/s]evaluate test:  57%|█████▋    | 217/378 [00:10<00:06, 24.71it/s]evaluate test:  58%|█████▊    | 220/378 [00:10<00:06, 24.92it/s]evaluate test:  59%|█████▉    | 223/378 [00:10<00:06, 24.97it/s]evaluate test:  60%|█████▉    | 226/378 [00:10<00:06, 25.20it/s]evaluate test:  61%|██████    | 229/378 [00:10<00:06, 22.23it/s]evaluate test:  61%|██████▏   | 232/378 [00:10<00:06, 23.05it/s]evaluate test:  62%|██████▏   | 235/378 [00:10<00:06, 22.87it/s]evaluate test:  63%|██████▎   | 238/378 [00:11<00:05, 23.44it/s]evaluate test:  64%|██████▍   | 241/378 [00:11<00:05, 24.00it/s]evaluate test:  65%|██████▍   | 244/378 [00:11<00:05, 24.45it/s]evaluate test:  65%|██████▌   | 247/378 [00:11<00:05, 24.65it/s]evaluate test:  66%|██████▌   | 250/378 [00:11<00:05, 24.79it/s]evaluate test:  67%|██████▋   | 253/378 [00:11<00:05, 25.00it/s]evaluate test:  68%|██████▊   | 256/378 [00:11<00:04, 25.00it/s]evaluate test:  69%|██████▊   | 259/378 [00:11<00:04, 25.12it/s]evaluate test:  69%|██████▉   | 262/378 [00:12<00:04, 25.12it/s]evaluate test:  70%|███████   | 265/378 [00:12<00:04, 24.23it/s]evaluate test:  71%|███████   | 268/378 [00:12<00:04, 24.39it/s]evaluate test:  72%|███████▏  | 271/378 [00:12<00:04, 24.38it/s]evaluate test:  72%|███████▏  | 274/378 [00:12<00:04, 24.70it/s]evaluate test:  73%|███████▎  | 277/378 [00:12<00:04, 24.92it/s]evaluate test:  74%|███████▍  | 280/378 [00:12<00:03, 25.17it/s]evaluate test:  75%|███████▍  | 283/378 [00:12<00:03, 25.25it/s]evaluate test:  76%|███████▌  | 286/378 [00:12<00:03, 25.41it/s]evaluate test:  76%|███████▋  | 289/378 [00:13<00:03, 24.06it/s]evaluate test:  77%|███████▋  | 292/378 [00:13<00:03, 23.62it/s]evaluate test:  78%|███████▊  | 295/378 [00:13<00:03, 24.10it/s]evaluate test:  79%|███████▉  | 298/378 [00:13<00:03, 23.80it/s]evaluate test:  80%|███████▉  | 301/378 [00:13<00:03, 24.40it/s]evaluate test:  80%|████████  | 304/378 [00:13<00:02, 24.80it/s]evaluate test:  81%|████████  | 307/378 [00:13<00:02, 25.07it/s]evaluate test:  82%|████████▏ | 310/378 [00:13<00:02, 25.08it/s]evaluate test:  83%|████████▎ | 313/378 [00:14<00:02, 25.18it/s]evaluate test:  84%|████████▎ | 316/378 [00:14<00:02, 25.25it/s]evaluate test:  84%|████████▍ | 319/378 [00:14<00:02, 25.31it/s]evaluate test:  85%|████████▌ | 322/378 [00:14<00:02, 25.09it/s]evaluate test:  86%|████████▌ | 325/378 [00:14<00:02, 24.92it/s]evaluate test:  87%|████████▋ | 328/378 [00:14<00:02, 24.62it/s]evaluate test:  88%|████████▊ | 331/378 [00:14<00:01, 24.18it/s]evaluate test:  88%|████████▊ | 334/378 [00:14<00:01, 24.20it/s]evaluate test:  89%|████████▉ | 337/378 [00:15<00:01, 24.12it/s]evaluate test:  90%|████████▉ | 340/378 [00:15<00:01, 24.55it/s]evaluate test:  91%|█████████ | 343/378 [00:15<00:01, 24.87it/s]evaluate test:  92%|█████████▏| 346/378 [00:15<00:01, 25.09it/s]evaluate test:  92%|█████████▏| 349/378 [00:15<00:01, 22.13it/s]evaluate test:  93%|█████████▎| 352/378 [00:15<00:01, 22.97it/s]evaluate test:  94%|█████████▍| 355/378 [00:15<00:00, 23.71it/s]evaluate test:  95%|█████████▍| 358/378 [00:15<00:00, 24.16it/s]evaluate test:  96%|█████████▌| 361/378 [00:16<00:00, 24.47it/s]evaluate test:  96%|█████████▋| 364/378 [00:16<00:00, 23.79it/s]evaluate test:  97%|█████████▋| 367/378 [00:16<00:00, 22.85it/s]evaluate test:  98%|█████████▊| 370/378 [00:16<00:00, 23.07it/s]evaluate test:  99%|█████████▊| 373/378 [00:16<00:00, 23.36it/s]evaluate test:  99%|█████████▉| 376/378 [00:16<00:00, 24.00it/s]evaluate test: 100%|██████████| 378/378 [00:16<00:00, 22.53it/s]
08/19/2022 09:48:55 - INFO - __main__ -   ***** Test results *****
08/19/2022 09:48:55 - INFO - __main__ -     test_accuracy = 0.9874
08/19/2022 09:48:55 - INFO - __main__ -     test_f1 = 0.8914
08/19/2022 09:48:55 - INFO - __main__ -     test_precision = 0.9398
08/19/2022 09:48:55 - INFO - __main__ -     test_recall = 0.8478
08/19/2022 09:48:55 - INFO - __main__ -     test_threshold = 0.5
