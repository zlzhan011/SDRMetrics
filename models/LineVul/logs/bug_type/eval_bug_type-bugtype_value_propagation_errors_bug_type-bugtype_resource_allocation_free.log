08/19/2022 09:47:43 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of the model checkpoint at microsoft/codebert-base were not used when initializing RobertaForSequenceClassification: ['pooler.dense.bias', 'pooler.dense.weight']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.weight', 'classifier.out_proj.weight', 'classifier.dense.bias', 'classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/19/2022 09:47:53 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file=None, output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file=None, test_data_file='../data/subsets/bug_type/bugtype_value_propagation_errors/test.csv', model_name='bug_type/bugtype_resource_allocation_free', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=4, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
load dataset:   0%|          | 0/1512 [00:00<?, ?it/s]load dataset:   3%|▎         | 47/1512 [00:00<00:03, 465.91it/s]load dataset:   6%|▋         | 98/1512 [00:00<00:02, 490.64it/s]load dataset:  10%|▉         | 148/1512 [00:00<00:03, 436.74it/s]load dataset:  13%|█▎        | 193/1512 [00:00<00:04, 325.90it/s]load dataset:  17%|█▋        | 254/1512 [00:00<00:03, 403.43it/s]load dataset:  20%|██        | 308/1512 [00:00<00:02, 440.97it/s]load dataset:  24%|██▎       | 356/1512 [00:00<00:03, 364.91it/s]load dataset:  27%|██▋       | 413/1512 [00:01<00:02, 415.96it/s]load dataset:  30%|███       | 459/1512 [00:01<00:02, 354.97it/s]load dataset:  33%|███▎      | 499/1512 [00:01<00:02, 361.19it/s]load dataset:  36%|███▌      | 544/1512 [00:01<00:02, 380.01it/s]load dataset:  39%|███▊      | 585/1512 [00:01<00:02, 365.29it/s]load dataset:  42%|████▏     | 631/1512 [00:01<00:02, 379.67it/s]load dataset:  44%|████▍     | 671/1512 [00:01<00:02, 344.93it/s]load dataset:  47%|████▋     | 707/1512 [00:01<00:02, 324.42it/s]load dataset:  49%|████▉     | 741/1512 [00:02<00:02, 313.04it/s]load dataset:  51%|█████▏    | 778/1512 [00:02<00:02, 327.45it/s]load dataset:  54%|█████▎    | 812/1512 [00:02<00:02, 272.24it/s]load dataset:  56%|█████▋    | 852/1512 [00:02<00:02, 300.60it/s]load dataset:  59%|█████▉    | 889/1512 [00:02<00:01, 314.94it/s]load dataset:  61%|██████    | 926/1512 [00:02<00:01, 328.63it/s]load dataset:  64%|██████▍   | 964/1512 [00:02<00:01, 342.26it/s]load dataset:  66%|██████▌   | 1000/1512 [00:02<00:01, 318.00it/s]load dataset:  68%|██████▊   | 1033/1512 [00:02<00:01, 305.49it/s]load dataset:  71%|███████▏  | 1078/1512 [00:03<00:01, 342.31it/s]load dataset:  74%|███████▎  | 1114/1512 [00:03<00:01, 235.07it/s]load dataset:  76%|███████▌  | 1143/1512 [00:03<00:01, 241.52it/s]load dataset:  79%|███████▉  | 1193/1512 [00:03<00:01, 298.89it/s]load dataset:  81%|████████  | 1228/1512 [00:03<00:00, 292.53it/s]load dataset:  85%|████████▍ | 1280/1512 [00:03<00:00, 348.53it/s]load dataset:  87%|████████▋ | 1319/1512 [00:03<00:00, 324.95it/s]load dataset:  90%|████████▉ | 1355/1512 [00:04<00:00, 290.40it/s]load dataset:  93%|█████████▎| 1399/1512 [00:04<00:00, 325.68it/s]load dataset:  95%|█████████▍| 1435/1512 [00:04<00:00, 274.26it/s]load dataset:  97%|█████████▋| 1466/1512 [00:04<00:00, 278.30it/s]load dataset:  99%|█████████▉| 1496/1512 [00:04<00:00, 247.53it/s]load dataset: 100%|██████████| 1512/1512 [00:04<00:00, 321.65it/s]
08/19/2022 09:48:02 - INFO - __main__ -   ***** Running Test *****
08/19/2022 09:48:02 - INFO - __main__ -     Num examples = 1512
08/19/2022 09:48:02 - INFO - __main__ -     Batch size = 4
evaluate test:   0%|          | 0/378 [00:00<?, ?it/s]evaluate test:   0%|          | 1/378 [00:00<05:14,  1.20it/s]evaluate test:   1%|          | 4/378 [00:00<01:11,  5.26it/s]evaluate test:   2%|▏         | 7/378 [00:01<00:41,  9.02it/s]evaluate test:   3%|▎         | 10/378 [00:01<00:29, 12.38it/s]evaluate test:   3%|▎         | 13/378 [00:01<00:23, 15.27it/s]evaluate test:   4%|▍         | 16/378 [00:01<00:20, 17.54it/s]evaluate test:   5%|▌         | 19/378 [00:01<00:18, 19.62it/s]evaluate test:   6%|▌         | 22/378 [00:01<00:16, 21.30it/s]evaluate test:   7%|▋         | 25/378 [00:01<00:15, 22.48it/s]evaluate test:   7%|▋         | 28/378 [00:01<00:15, 22.49it/s]evaluate test:   8%|▊         | 31/378 [00:02<00:15, 22.72it/s]evaluate test:   9%|▉         | 34/378 [00:02<00:14, 23.53it/s]evaluate test:  10%|▉         | 37/378 [00:02<00:14, 24.07it/s]evaluate test:  11%|█         | 40/378 [00:02<00:13, 24.42it/s]evaluate test:  11%|█▏        | 43/378 [00:02<00:13, 24.78it/s]evaluate test:  12%|█▏        | 46/378 [00:02<00:13, 25.05it/s]evaluate test:  13%|█▎        | 49/378 [00:02<00:13, 25.17it/s]evaluate test:  14%|█▍        | 52/378 [00:02<00:12, 25.35it/s]evaluate test:  15%|█▍        | 55/378 [00:03<00:12, 25.52it/s]evaluate test:  15%|█▌        | 58/378 [00:03<00:13, 24.50it/s]evaluate test:  16%|█▌        | 61/378 [00:03<00:12, 24.54it/s]evaluate test:  17%|█▋        | 64/378 [00:03<00:12, 24.23it/s]evaluate test:  18%|█▊        | 67/378 [00:03<00:12, 24.43it/s]evaluate test:  19%|█▊        | 70/378 [00:03<00:12, 24.72it/s]evaluate test:  19%|█▉        | 73/378 [00:03<00:12, 25.02it/s]evaluate test:  20%|██        | 76/378 [00:03<00:11, 25.29it/s]evaluate test:  21%|██        | 79/378 [00:03<00:11, 25.28it/s]evaluate test:  22%|██▏       | 82/378 [00:04<00:11, 25.50it/s]evaluate test:  22%|██▏       | 85/378 [00:04<00:11, 25.53it/s]evaluate test:  23%|██▎       | 88/378 [00:04<00:11, 25.64it/s]evaluate test:  24%|██▍       | 91/378 [00:04<00:11, 24.96it/s]evaluate test:  25%|██▍       | 94/378 [00:04<00:11, 24.73it/s]evaluate test:  26%|██▌       | 97/378 [00:04<00:11, 24.98it/s]evaluate test:  26%|██▋       | 100/378 [00:04<00:11, 25.26it/s]evaluate test:  27%|██▋       | 103/378 [00:04<00:10, 25.44it/s]evaluate test:  28%|██▊       | 106/378 [00:05<00:10, 25.53it/s]evaluate test:  29%|██▉       | 109/378 [00:05<00:10, 25.66it/s]evaluate test:  30%|██▉       | 112/378 [00:05<00:10, 25.73it/s]evaluate test:  30%|███       | 115/378 [00:05<00:10, 25.52it/s]evaluate test:  31%|███       | 118/378 [00:05<00:10, 25.44it/s]evaluate test:  32%|███▏      | 121/378 [00:05<00:10, 24.91it/s]evaluate test:  33%|███▎      | 124/378 [00:05<00:10, 24.46it/s]evaluate test:  34%|███▎      | 127/378 [00:05<00:10, 24.39it/s]evaluate test:  34%|███▍      | 130/378 [00:06<00:10, 24.53it/s]evaluate test:  35%|███▌      | 133/378 [00:06<00:10, 23.07it/s]evaluate test:  36%|███▌      | 136/378 [00:06<00:10, 23.82it/s]evaluate test:  37%|███▋      | 139/378 [00:06<00:09, 24.38it/s]evaluate test:  38%|███▊      | 142/378 [00:06<00:09, 24.74it/s]evaluate test:  38%|███▊      | 145/378 [00:06<00:09, 25.20it/s]evaluate test:  39%|███▉      | 148/378 [00:06<00:09, 25.44it/s]evaluate test:  40%|███▉      | 151/378 [00:06<00:09, 24.64it/s]evaluate test:  41%|████      | 154/378 [00:06<00:09, 24.78it/s]evaluate test:  42%|████▏     | 157/378 [00:07<00:08, 24.90it/s]evaluate test:  42%|████▏     | 160/378 [00:07<00:08, 25.15it/s]evaluate test:  43%|████▎     | 163/378 [00:07<00:08, 25.33it/s]evaluate test:  44%|████▍     | 166/378 [00:07<00:08, 25.45it/s]evaluate test:  45%|████▍     | 169/378 [00:07<00:08, 25.42it/s]evaluate test:  46%|████▌     | 172/378 [00:07<00:08, 25.46it/s]evaluate test:  46%|████▋     | 175/378 [00:07<00:07, 25.53it/s]evaluate test:  47%|████▋     | 178/378 [00:07<00:07, 25.65it/s]evaluate test:  48%|████▊     | 181/378 [00:08<00:07, 25.45it/s]evaluate test:  49%|████▊     | 184/378 [00:08<00:07, 24.43it/s]evaluate test:  49%|████▉     | 187/378 [00:08<00:08, 22.16it/s]evaluate test:  50%|█████     | 190/378 [00:08<00:08, 22.66it/s]evaluate test:  51%|█████     | 193/378 [00:08<00:07, 23.18it/s]evaluate test:  52%|█████▏    | 196/378 [00:08<00:07, 23.89it/s]evaluate test:  53%|█████▎    | 199/378 [00:08<00:07, 24.34it/s]evaluate test:  53%|█████▎    | 202/378 [00:08<00:07, 24.71it/s]evaluate test:  54%|█████▍    | 205/378 [00:09<00:06, 25.00it/s]evaluate test:  55%|█████▌    | 208/378 [00:09<00:06, 25.16it/s]evaluate test:  56%|█████▌    | 211/378 [00:09<00:06, 25.44it/s]evaluate test:  57%|█████▋    | 214/378 [00:09<00:06, 25.16it/s]evaluate test:  57%|█████▋    | 217/378 [00:09<00:06, 25.13it/s]evaluate test:  58%|█████▊    | 220/378 [00:09<00:06, 25.36it/s]evaluate test:  59%|█████▉    | 223/378 [00:09<00:06, 25.25it/s]evaluate test:  60%|█████▉    | 226/378 [00:09<00:06, 25.33it/s]evaluate test:  61%|██████    | 229/378 [00:10<00:05, 25.51it/s]evaluate test:  61%|██████▏   | 232/378 [00:10<00:05, 25.32it/s]evaluate test:  62%|██████▏   | 235/378 [00:10<00:05, 25.42it/s]evaluate test:  63%|██████▎   | 238/378 [00:10<00:05, 25.27it/s]evaluate test:  64%|██████▍   | 241/378 [00:10<00:05, 24.64it/s]evaluate test:  65%|██████▍   | 244/378 [00:10<00:05, 22.51it/s]evaluate test:  65%|██████▌   | 247/378 [00:10<00:05, 22.69it/s]evaluate test:  66%|██████▌   | 250/378 [00:10<00:05, 23.20it/s]evaluate test:  67%|██████▋   | 253/378 [00:11<00:05, 23.57it/s]evaluate test:  68%|██████▊   | 256/378 [00:11<00:05, 23.43it/s]evaluate test:  69%|██████▊   | 259/378 [00:11<00:04, 23.97it/s]evaluate test:  69%|██████▉   | 262/378 [00:11<00:04, 24.26it/s]evaluate test:  70%|███████   | 265/378 [00:11<00:04, 24.37it/s]evaluate test:  71%|███████   | 268/378 [00:11<00:04, 24.77it/s]evaluate test:  72%|███████▏  | 271/378 [00:11<00:04, 24.82it/s]evaluate test:  72%|███████▏  | 274/378 [00:11<00:04, 24.75it/s]evaluate test:  73%|███████▎  | 277/378 [00:11<00:04, 24.58it/s]evaluate test:  74%|███████▍  | 280/378 [00:12<00:03, 24.73it/s]evaluate test:  75%|███████▍  | 283/378 [00:12<00:03, 24.85it/s]evaluate test:  76%|███████▌  | 286/378 [00:12<00:03, 25.03it/s]evaluate test:  76%|███████▋  | 289/378 [00:12<00:03, 25.38it/s]evaluate test:  77%|███████▋  | 292/378 [00:12<00:03, 25.38it/s]evaluate test:  78%|███████▊  | 295/378 [00:12<00:03, 25.57it/s]evaluate test:  79%|███████▉  | 298/378 [00:12<00:03, 25.66it/s]evaluate test:  80%|███████▉  | 301/378 [00:12<00:03, 22.53it/s]evaluate test:  80%|████████  | 304/378 [00:13<00:03, 22.37it/s]evaluate test:  81%|████████  | 307/378 [00:13<00:03, 23.13it/s]evaluate test:  82%|████████▏ | 310/378 [00:13<00:02, 23.78it/s]evaluate test:  83%|████████▎ | 313/378 [00:13<00:02, 24.31it/s]evaluate test:  84%|████████▎ | 316/378 [00:13<00:02, 24.63it/s]evaluate test:  84%|████████▍ | 319/378 [00:13<00:02, 24.82it/s]evaluate test:  85%|████████▌ | 322/378 [00:13<00:02, 24.92it/s]evaluate test:  86%|████████▌ | 325/378 [00:13<00:02, 24.98it/s]evaluate test:  87%|████████▋ | 328/378 [00:14<00:01, 25.08it/s]evaluate test:  88%|████████▊ | 331/378 [00:14<00:01, 25.12it/s]evaluate test:  88%|████████▊ | 334/378 [00:14<00:01, 25.04it/s]evaluate test:  89%|████████▉ | 337/378 [00:14<00:01, 25.18it/s]evaluate test:  90%|████████▉ | 340/378 [00:14<00:01, 25.45it/s]evaluate test:  91%|█████████ | 343/378 [00:14<00:01, 25.80it/s]evaluate test:  92%|█████████▏| 346/378 [00:14<00:01, 25.97it/s]evaluate test:  92%|█████████▏| 349/378 [00:14<00:01, 26.07it/s]evaluate test:  93%|█████████▎| 352/378 [00:14<00:00, 26.11it/s]evaluate test:  94%|█████████▍| 355/378 [00:15<00:00, 23.57it/s]evaluate test:  95%|█████████▍| 358/378 [00:15<00:00, 23.70it/s]evaluate test:  96%|█████████▌| 361/378 [00:15<00:00, 23.82it/s]evaluate test:  96%|█████████▋| 364/378 [00:15<00:00, 23.97it/s]evaluate test:  97%|█████████▋| 367/378 [00:15<00:00, 24.13it/s]evaluate test:  98%|█████████▊| 370/378 [00:15<00:00, 24.57it/s]evaluate test:  99%|█████████▊| 373/378 [00:15<00:00, 24.77it/s]evaluate test:  99%|█████████▉| 376/378 [00:16<00:00, 24.97it/s]evaluate test: 100%|██████████| 378/378 [00:16<00:00, 23.49it/s]
08/19/2022 09:48:18 - INFO - __main__ -   ***** Test results *****
08/19/2022 09:48:18 - INFO - __main__ -     test_accuracy = 0.9808
08/19/2022 09:48:18 - INFO - __main__ -     test_f1 = 0.8362
08/19/2022 09:48:18 - INFO - __main__ -     test_precision = 0.8706
08/19/2022 09:48:18 - INFO - __main__ -     test_recall = 0.8043
08/19/2022 09:48:18 - INFO - __main__ -     test_threshold = 0.5
