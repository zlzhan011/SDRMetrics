08/19/2022 09:47:06 - WARNING - __main__ -   device: cuda, n_gpu: 1
Some weights of the model checkpoint at microsoft/codebert-base were not used when initializing RobertaForSequenceClassification: ['pooler.dense.bias', 'pooler.dense.weight']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.out_proj.weight', 'classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
08/19/2022 09:47:13 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file=None, output_dir='./saved_models', model_type='roberta', block_size=512, eval_data_file=None, test_data_file='../data/subsets/bug_type/bugtype_value_propagation_errors/test.csv', model_name='bug_type/bugtype_privilege_escalation_authorization', model_name_or_path='microsoft/codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='microsoft/codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=4, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, effort_at_top_k=0.2, top_k_recall_by_lines=0.01, top_k_recall_by_pred_prob=0.2, do_sorting_by_line_scores=False, do_sorting_by_pred_prob=False, top_k_constant=10, num_attention_heads=12, write_raw_preds=False, use_word_level_tokenizer=False, use_non_pretrained_tokenizer=False, n_gpu=1, device=device(type='cuda'))
load dataset:   0%|          | 0/1512 [00:00<?, ?it/s]load dataset:   3%|▎         | 41/1512 [00:00<00:03, 408.00it/s]load dataset:   6%|▋         | 95/1512 [00:00<00:02, 484.39it/s]load dataset:  10%|▉         | 144/1512 [00:00<00:03, 388.77it/s]load dataset:  12%|█▏        | 185/1512 [00:00<00:04, 289.41it/s]load dataset:  15%|█▌        | 230/1512 [00:00<00:03, 327.12it/s]load dataset:  18%|█▊        | 267/1512 [00:00<00:03, 325.88it/s]load dataset:  20%|██        | 306/1512 [00:00<00:03, 330.54it/s]load dataset:  24%|██▎       | 358/1512 [00:00<00:03, 380.34it/s]load dataset:  28%|██▊       | 421/1512 [00:01<00:02, 446.10it/s]load dataset:  31%|███       | 468/1512 [00:01<00:02, 444.81it/s]load dataset:  36%|███▌      | 537/1512 [00:01<00:01, 513.82it/s]load dataset:  39%|███▉      | 590/1512 [00:01<00:01, 484.02it/s]load dataset:  42%|████▏     | 640/1512 [00:01<00:02, 410.45it/s]load dataset:  45%|████▌     | 684/1512 [00:01<00:02, 404.79it/s]load dataset:  48%|████▊     | 727/1512 [00:01<00:02, 373.39it/s]load dataset:  51%|█████     | 766/1512 [00:01<00:02, 356.31it/s]load dataset:  53%|█████▎    | 803/1512 [00:02<00:02, 285.24it/s]load dataset:  55%|█████▌    | 835/1512 [00:02<00:02, 287.12it/s]load dataset:  57%|█████▋    | 866/1512 [00:02<00:02, 277.66it/s]load dataset:  59%|█████▉    | 896/1512 [00:02<00:02, 282.95it/s]load dataset:  63%|██████▎   | 950/1512 [00:02<00:01, 347.86it/s]load dataset:  65%|██████▌   | 989/1512 [00:02<00:01, 358.08it/s]load dataset:  68%|██████▊   | 1027/1512 [00:02<00:01, 309.97it/s]load dataset:  71%|███████   | 1074/1512 [00:02<00:01, 344.42it/s]load dataset:  73%|███████▎  | 1111/1512 [00:03<00:01, 242.62it/s]load dataset:  77%|███████▋  | 1163/1512 [00:03<00:01, 299.01it/s]load dataset:  80%|████████  | 1214/1512 [00:03<00:00, 344.39it/s]load dataset:  83%|████████▎ | 1260/1512 [00:03<00:00, 366.84it/s]load dataset:  86%|████████▌ | 1302/1512 [00:03<00:00, 347.80it/s]load dataset:  89%|████████▉ | 1342/1512 [00:03<00:00, 360.11it/s]load dataset:  92%|█████████▏| 1391/1512 [00:03<00:00, 393.93it/s]load dataset:  95%|█████████▍| 1433/1512 [00:04<00:00, 348.86it/s]load dataset:  97%|█████████▋| 1471/1512 [00:04<00:00, 326.71it/s]load dataset: 100%|█████████▉| 1506/1512 [00:04<00:00, 303.41it/s]load dataset: 100%|██████████| 1512/1512 [00:04<00:00, 346.66it/s]
08/19/2022 09:47:22 - INFO - __main__ -   ***** Running Test *****
08/19/2022 09:47:22 - INFO - __main__ -     Num examples = 1512
08/19/2022 09:47:22 - INFO - __main__ -     Batch size = 4
evaluate test:   0%|          | 0/378 [00:00<?, ?it/s]evaluate test:   0%|          | 1/378 [00:01<06:46,  1.08s/it]evaluate test:   1%|          | 4/378 [00:01<01:27,  4.25it/s]evaluate test:   2%|▏         | 7/378 [00:01<00:48,  7.65it/s]evaluate test:   3%|▎         | 10/378 [00:01<00:33, 10.86it/s]evaluate test:   3%|▎         | 13/378 [00:01<00:26, 13.72it/s]evaluate test:   4%|▍         | 16/378 [00:01<00:22, 16.33it/s]evaluate test:   5%|▌         | 19/378 [00:01<00:20, 17.13it/s]evaluate test:   6%|▌         | 22/378 [00:01<00:18, 18.98it/s]evaluate test:   7%|▋         | 25/378 [00:02<00:17, 20.40it/s]evaluate test:   7%|▋         | 28/378 [00:02<00:16, 21.74it/s]evaluate test:   8%|▊         | 31/378 [00:02<00:15, 22.65it/s]evaluate test:   9%|▉         | 34/378 [00:02<00:14, 23.07it/s]evaluate test:  10%|▉         | 37/378 [00:02<00:14, 23.08it/s]evaluate test:  11%|█         | 40/378 [00:02<00:14, 23.44it/s]evaluate test:  11%|█▏        | 43/378 [00:02<00:13, 23.99it/s]evaluate test:  12%|█▏        | 46/378 [00:02<00:13, 24.34it/s]evaluate test:  13%|█▎        | 49/378 [00:03<00:13, 24.55it/s]evaluate test:  14%|█▍        | 52/378 [00:03<00:13, 24.82it/s]evaluate test:  15%|█▍        | 55/378 [00:03<00:12, 25.02it/s]evaluate test:  15%|█▌        | 58/378 [00:03<00:12, 25.12it/s]evaluate test:  16%|█▌        | 61/378 [00:03<00:12, 25.51it/s]evaluate test:  17%|█▋        | 64/378 [00:03<00:12, 25.53it/s]evaluate test:  18%|█▊        | 67/378 [00:03<00:12, 24.47it/s]evaluate test:  19%|█▊        | 70/378 [00:03<00:12, 24.67it/s]evaluate test:  19%|█▉        | 73/378 [00:04<00:12, 24.84it/s]evaluate test:  20%|██        | 76/378 [00:04<00:13, 22.63it/s]evaluate test:  21%|██        | 79/378 [00:04<00:12, 23.29it/s]evaluate test:  22%|██▏       | 82/378 [00:04<00:12, 23.95it/s]evaluate test:  22%|██▏       | 85/378 [00:04<00:11, 24.50it/s]evaluate test:  23%|██▎       | 88/378 [00:04<00:11, 24.94it/s]evaluate test:  24%|██▍       | 91/378 [00:04<00:11, 25.12it/s]evaluate test:  25%|██▍       | 94/378 [00:04<00:11, 25.19it/s]evaluate test:  26%|██▌       | 97/378 [00:05<00:11, 25.11it/s]evaluate test:  26%|██▋       | 100/378 [00:05<00:11, 24.04it/s]evaluate test:  27%|██▋       | 103/378 [00:05<00:11, 24.30it/s]evaluate test:  28%|██▊       | 106/378 [00:05<00:11, 24.35it/s]evaluate test:  29%|██▉       | 109/378 [00:05<00:11, 24.42it/s]evaluate test:  30%|██▉       | 112/378 [00:05<00:10, 24.59it/s]evaluate test:  30%|███       | 115/378 [00:05<00:10, 24.88it/s]evaluate test:  31%|███       | 118/378 [00:05<00:10, 25.08it/s]evaluate test:  32%|███▏      | 121/378 [00:05<00:10, 25.21it/s]evaluate test:  33%|███▎      | 124/378 [00:06<00:09, 25.43it/s]evaluate test:  34%|███▎      | 127/378 [00:06<00:09, 25.32it/s]evaluate test:  34%|███▍      | 130/378 [00:06<00:09, 25.09it/s]evaluate test:  35%|███▌      | 133/378 [00:06<00:09, 24.98it/s]evaluate test:  36%|███▌      | 136/378 [00:06<00:10, 22.87it/s]evaluate test:  37%|███▋      | 139/378 [00:06<00:10, 23.36it/s]evaluate test:  38%|███▊      | 142/378 [00:06<00:10, 23.47it/s]evaluate test:  38%|███▊      | 145/378 [00:06<00:09, 23.98it/s]evaluate test:  39%|███▉      | 148/378 [00:07<00:09, 24.28it/s]evaluate test:  40%|███▉      | 151/378 [00:07<00:09, 24.64it/s]evaluate test:  41%|████      | 154/378 [00:07<00:08, 24.92it/s]evaluate test:  42%|████▏     | 157/378 [00:07<00:08, 25.10it/s]evaluate test:  42%|████▏     | 160/378 [00:07<00:08, 25.13it/s]evaluate test:  43%|████▎     | 163/378 [00:07<00:08, 24.97it/s]evaluate test:  44%|████▍     | 166/378 [00:07<00:08, 25.06it/s]evaluate test:  45%|████▍     | 169/378 [00:07<00:08, 25.11it/s]evaluate test:  46%|████▌     | 172/378 [00:08<00:08, 25.38it/s]evaluate test:  46%|████▋     | 175/378 [00:08<00:07, 25.65it/s]evaluate test:  47%|████▋     | 178/378 [00:08<00:07, 25.68it/s]evaluate test:  48%|████▊     | 181/378 [00:08<00:07, 25.77it/s]evaluate test:  49%|████▊     | 184/378 [00:08<00:07, 25.86it/s]evaluate test:  49%|████▉     | 187/378 [00:08<00:07, 25.98it/s]evaluate test:  50%|█████     | 190/378 [00:08<00:07, 25.99it/s]evaluate test:  51%|█████     | 193/378 [00:08<00:07, 23.17it/s]evaluate test:  52%|█████▏    | 196/378 [00:09<00:07, 23.58it/s]evaluate test:  53%|█████▎    | 199/378 [00:09<00:07, 24.04it/s]evaluate test:  53%|█████▎    | 202/378 [00:09<00:07, 24.63it/s]evaluate test:  54%|█████▍    | 205/378 [00:09<00:06, 25.00it/s]evaluate test:  55%|█████▌    | 208/378 [00:09<00:06, 25.22it/s]evaluate test:  56%|█████▌    | 211/378 [00:09<00:06, 25.37it/s]evaluate test:  57%|█████▋    | 214/378 [00:09<00:06, 25.45it/s]evaluate test:  57%|█████▋    | 217/378 [00:09<00:06, 25.70it/s]evaluate test:  58%|█████▊    | 220/378 [00:09<00:06, 26.11it/s]evaluate test:  59%|█████▉    | 223/378 [00:10<00:05, 26.36it/s]evaluate test:  60%|█████▉    | 226/378 [00:10<00:05, 26.46it/s]evaluate test:  61%|██████    | 229/378 [00:10<00:05, 26.28it/s]evaluate test:  61%|██████▏   | 232/378 [00:10<00:05, 26.58it/s]evaluate test:  62%|██████▏   | 235/378 [00:10<00:05, 26.00it/s]evaluate test:  63%|██████▎   | 238/378 [00:10<00:05, 26.63it/s]evaluate test:  64%|██████▍   | 241/378 [00:10<00:05, 26.72it/s]evaluate test:  65%|██████▍   | 244/378 [00:10<00:05, 26.65it/s]evaluate test:  65%|██████▌   | 247/378 [00:10<00:04, 26.59it/s]evaluate test:  66%|██████▌   | 250/378 [00:11<00:04, 26.13it/s]evaluate test:  67%|██████▋   | 253/378 [00:11<00:04, 25.46it/s]evaluate test:  68%|██████▊   | 256/378 [00:11<00:04, 24.48it/s]evaluate test:  69%|██████▊   | 259/378 [00:11<00:04, 24.09it/s]evaluate test:  69%|██████▉   | 262/378 [00:11<00:05, 21.58it/s]evaluate test:  70%|███████   | 265/378 [00:11<00:05, 22.42it/s]evaluate test:  71%|███████   | 268/378 [00:11<00:04, 23.25it/s]evaluate test:  72%|███████▏  | 271/378 [00:12<00:04, 23.76it/s]evaluate test:  72%|███████▏  | 274/378 [00:12<00:04, 24.37it/s]evaluate test:  73%|███████▎  | 277/378 [00:12<00:04, 24.88it/s]evaluate test:  74%|███████▍  | 280/378 [00:12<00:03, 24.89it/s]evaluate test:  75%|███████▍  | 283/378 [00:12<00:03, 24.75it/s]evaluate test:  76%|███████▌  | 286/378 [00:12<00:03, 24.82it/s]evaluate test:  76%|███████▋  | 289/378 [00:12<00:03, 24.55it/s]evaluate test:  77%|███████▋  | 292/378 [00:12<00:03, 24.95it/s]evaluate test:  78%|███████▊  | 295/378 [00:12<00:03, 25.11it/s]evaluate test:  79%|███████▉  | 298/378 [00:13<00:03, 25.09it/s]evaluate test:  80%|███████▉  | 301/378 [00:13<00:03, 25.16it/s]evaluate test:  80%|████████  | 304/378 [00:13<00:02, 25.19it/s]evaluate test:  81%|████████  | 307/378 [00:13<00:02, 25.21it/s]evaluate test:  82%|████████▏ | 310/378 [00:13<00:02, 25.30it/s]evaluate test:  83%|████████▎ | 313/378 [00:13<00:02, 23.82it/s]evaluate test:  84%|████████▎ | 316/378 [00:13<00:02, 23.78it/s]evaluate test:  84%|████████▍ | 319/378 [00:13<00:02, 24.20it/s]evaluate test:  85%|████████▌ | 322/378 [00:14<00:02, 24.52it/s]evaluate test:  86%|████████▌ | 325/378 [00:14<00:02, 24.72it/s]evaluate test:  87%|████████▋ | 328/378 [00:14<00:02, 24.99it/s]evaluate test:  88%|████████▊ | 331/378 [00:14<00:01, 25.07it/s]evaluate test:  88%|████████▊ | 334/378 [00:14<00:01, 24.93it/s]evaluate test:  89%|████████▉ | 337/378 [00:14<00:01, 24.97it/s]evaluate test:  90%|████████▉ | 340/378 [00:14<00:01, 25.20it/s]evaluate test:  91%|█████████ | 343/378 [00:14<00:01, 25.40it/s]evaluate test:  92%|█████████▏| 346/378 [00:15<00:01, 25.20it/s]evaluate test:  92%|█████████▏| 349/378 [00:15<00:01, 24.87it/s]evaluate test:  93%|█████████▎| 352/378 [00:15<00:01, 25.07it/s]evaluate test:  94%|█████████▍| 355/378 [00:15<00:00, 25.17it/s]evaluate test:  95%|█████████▍| 358/378 [00:15<00:00, 25.06it/s]evaluate test:  96%|█████████▌| 361/378 [00:15<00:00, 24.97it/s]evaluate test:  96%|█████████▋| 364/378 [00:15<00:00, 24.93it/s]evaluate test:  97%|█████████▋| 367/378 [00:15<00:00, 24.98it/s]evaluate test:  98%|█████████▊| 370/378 [00:15<00:00, 25.09it/s]evaluate test:  99%|█████████▊| 373/378 [00:16<00:00, 23.68it/s]evaluate test:  99%|█████████▉| 376/378 [00:16<00:00, 23.99it/s]evaluate test: 100%|██████████| 378/378 [00:16<00:00, 23.14it/s]
08/19/2022 09:47:38 - INFO - __main__ -   ***** Test results *****
08/19/2022 09:47:38 - INFO - __main__ -     test_accuracy = 0.9775
08/19/2022 09:47:38 - INFO - __main__ -     test_f1 = 0.8068
08/19/2022 09:47:38 - INFO - __main__ -     test_precision = 0.8452
08/19/2022 09:47:38 - INFO - __main__ -     test_recall = 0.7717
08/19/2022 09:47:38 - INFO - __main__ -     test_threshold = 0.5
